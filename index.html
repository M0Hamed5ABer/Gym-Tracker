<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="dumbbell.png" type="image/x-icon" />
    <title>Gym Tracker</title>
    <style>
      :root {
        --bg-color: #bdf7ff;
        --text-color: #000;
        --exercise-bg: #fff;
        --exercise-shadow: 0 0 10px #ccc;
        --button-bg: #eee;
        --button-color: #000;
        --button-hover-bg: #000;
        --button-hover-color: #fff;
        --input-bg: #fff;
        --input-color: #000;
        --input-border: 1px solid #ccc;
        --progress-bg: #f0f0f0;
        --progress-shadow: 0 0 10px #bbb;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù… */
      .dark-mode {
        --bg-color: #121212;
        --text-color: #fff;
        --exercise-bg: #1e1e1e;
        --exercise-shadow: 0 0 10px #555;
        --button-bg: #333;
        --button-color: #fff;
        --button-hover-bg: #fff;
        --button-hover-color: #000;
        --input-bg: #333;
        --input-color: #fff;
        --input-border: 1px solid #777;
        --progress-bg: #1e1e1e;
        --progress-shadow: 0 0 10px #555;
      }
      body {
        font-family: Arial;
        text-align: center;
        direction: rtl;
        background: var(--bg-color);
        color: var(--text-color);
        padding: 20px;
        margin-bottom: 60px;
        transition: background 0.3s, color 0.3s;
      }

      .exercise {
        background: var(--exercise-bg);
        margin: 10px auto;
        padding: 10px;
        width: 100%;
        max-width: 400px;
        border-radius: 8px;
        box-shadow: var(--exercise-shadow);
        color: var(--text-color);
      }

      button {
        padding: 8px 16px;
        margin: 8px 5px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        background-color: var(--button-bg);
        border: none;
        border-radius: 6px;
        color: var(--button-color);
        transition: background-color 0.3s, color 0.3s;
      }

      button:hover {
        color: var(--button-hover-color);
        background-color: var(--button-hover-bg);
      }

      input[type="number"],
      select {
        background-color: var(--input-bg);
        color: var(--input-color);
        border: var(--input-border);
        width: 100px;
        height: 40px;
        text-align: center;
        transition: background-color 0.3s, color 0.3s, border-color 0.3s;
      }

      #progressSection {
        margin: 20px auto;
        max-width: 400px;
        background: var(--progress-bg);
        border-radius: 8px;
        padding: 15px;
        box-shadow: var(--progress-shadow);
        color: var(--text-color);
        transition: background 0.3s, color 0.3s, box-shadow 0.3s;
      }

      .exercise-container {
        margin: 20px auto;
        max-width: 400px;
        background: var(--progress-bg);
        border-radius: 8px;
        padding: 15px;
        box-shadow: var(--progress-shadow);
        color: var(--text-color);
        transition: background 0.3s, color 0.3s, box-shadow 0.3s;
      }
      /* header */
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      /* Ø§Ù„Ø§Ù‚ØªØ±Ø­Ø§Øª */
      #addExerciseSection {
        position: relative; /* Ù…Ù‡Ù… Ù„Ø¬Ø¹Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„ØµØ­ÙŠØ­ */
      }

      .suggestions {
        position: absolute;
        color: var(--text-color);
        background: var(--exercise-bg);
        border: 1px solid var(--input-border);
        border-radius: 6px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        max-height: 200px;
        overflow-y: auto;
        width: 100%;
        z-index: 1000;
        display: none;
      }
      .suggestions div:hover {
        background-color: var(--button-hover-bg);
        color: var(--button-hover-color);
      }
      /* Ø§Ù„ØªØ·ÙˆØ± */
      #progressSection {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }
      .progress-controls {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
      }
    </style>
  </head>
  <body>
    <header>
      <button id="toggleDarkMode">ğŸŒ™</button>
      <h1 class="main-title">GYM TRACKER</h1>
    </header>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† -->
    <div id="exerciseTypes">
      <button onclick="showExercises('ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¯ÙØ¹')">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¯ÙØ¹</button>
      <button onclick="showExercises('ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨')">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨</button>
      <button onclick="showExercises('ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø±Ø¬Ù„')">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø±Ø¬Ù„</button>
      <button
        id="showAllBtn"
        onclick="showAllExercises()"
        style="display: none"
      >
        Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„
      </button>
    </div>

    <!-- Ø¥Ø¶Ø§ÙØ© ØªÙ…Ø±ÙŠÙ† -->
    <div id="addExerciseSection" style="margin: 20px auto; max-width: 400px">
      <select id="exerciseGroup" style="padding: 0px; font-size: 1rem">
        <option value="ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¯ÙØ¹">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¯ÙØ¹</option>
        <option value="ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨</option>
        <option value="ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø±Ø¬Ù„">ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø±Ø¬Ù„</option>
      </select>
      <input
        type="text"
        id="newExerciseName"
        placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ†"
        style="padding: 8px; width: 40%; font-size: 1rem"
        autocomplete="off"
      />
      <button onclick="addNewExercise()">â•</button>
      <div id="suggestions" class="suggestions"></div>
    </div>

    <div id="tracker"></div>

    <!-- Ø§Ø®ØªÙŠØ§Ø± ØªÙ…Ø±ÙŠÙ† Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ·ÙˆØ± -->
     <h2>Ø§Ù„ØªØ·ÙˆØ±Ø§Øª</h2>
    <div id="progressSection">
      <div class="progress-controls">
        <select id="exerciseSelector">
          <option value="">Ø§Ø®ØªØ± ØªÙ…Ø±ÙŠÙ†</option>
        </select>
  
        <div id="timeFilterSelect">
          <select id="timeFilterDropdown">
            <option value="day" selected>Ø¢Ø®Ø± ÙŠÙˆÙ…</option>
            <option value="week">Ø¢Ø®Ø± Ø£Ø³Ø¨ÙˆØ¹</option>
            <option value="month">Ø¢Ø®Ø± Ø´Ù‡Ø±</option>
            <option value="all">Ù…Ù†Ø° Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</option>
          </select>
        </div>
      </div>

      <div id="progressInfo"></div>
    </div>

    <button id="saveData">ğŸ’¾ Ø­ÙØ¸</button>
    <script>
      // Ù‚Ø§Ø¦Ù…Ø© ØªÙ…Ø§Ø±ÙŠÙ† Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø¹Ø±Ø¶Ù‡Ø§ ÙƒØ§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø©
      const defaultExercises = [
        "Ø¶ØºØ· ØµØ¯Ø±",
        "Ø³Ø­Ø¨ Ø®Ù„ÙÙŠ",
        "Ø³ÙƒÙˆØ§Øª",
        "Ø¶ØºØ· ÙƒØªÙ",
        "ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø¨Ø§ÙŠ",
        "ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªØ±Ø§ÙŠ",
        "Ø±ÙØ¹Ø© Ù…ÙŠØªØ©",
        "Ø·Ø¹Ù†Ø§Øª Ø§Ù„Ø±Ø¬Ù„",
        "ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ",
        "Ø¶ØºØ· Ø£Ø±Ø¬Ù„",
      ];

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ù…Ù† localStorage Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
      function loadExercises() {
        const saved = localStorage.getItem("exercises");
        if (saved) {
          return JSON.parse(saved);
        } else {
          return {
            "ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¯ÙØ¹": [],
            "ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨": [],
            "ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø±Ø¬Ù„": [],
          };
        }
      }

      // Ø­ÙØ¸ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ÙÙŠ localStorage
      function saveExercises() {
        localStorage.setItem("exercises", JSON.stringify(exercises));
      }

      const newExerciseInput = document.getElementById("newExerciseName");
      const suggestionsBox = document.getElementById("suggestions");

      // Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ÙÙŠ Ù…ØµÙÙˆÙØ© ÙˆØ§Ø­Ø¯Ø© (Ù„Ø§ ØªØªÙƒØ±Ø±)
      function getAllExerciseNames() {
        const all = [];
        for (const group in exercises) {
          all.push(...exercises[group]);
        }
        all.push(...defaultExercises);
        return [...new Set(all)];
      }

      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
      newExerciseInput.addEventListener("input", () => {
        const val = newExerciseInput.value.trim();
        suggestionsBox.innerHTML = "";
        if (!val) {
          suggestionsBox.style.display = "none";
          return;
        }
        const allNames = getAllExerciseNames();
        const filtered = allNames.filter((name) =>
          name.toLowerCase().includes(val.toLowerCase())
        );

        if (filtered.length === 0) {
          suggestionsBox.style.display = "none";
          return;
        }
        filtered.forEach((name) => {
          const div = document.createElement("div");
          div.textContent = name;
          div.style.padding = "6px";
          div.style.cursor = "pointer";
          div.addEventListener("click", () => {
            newExerciseInput.value = name;
            suggestionsBox.style.display = "none";
          });
          suggestionsBox.appendChild(div);
        });
        suggestionsBox.style.display = "block";
      });

      // Ø¥Ø®ÙØ§Ø¡ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø®Ø§Ù†Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø£Ùˆ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
      document.addEventListener("click", (e) => {
        if (
          e.target !== newExerciseInput &&
          e.target.parentNode !== suggestionsBox
        ) {
          suggestionsBox.style.display = "none";
        }
      });

      let exercises = loadExercises();

      const trackerDiv = document.getElementById("tracker");
      const saveBtn = document.getElementById("saveData");
      const exerciseSelector = document.getElementById("exerciseSelector");
      const progressInfo = document.getElementById("progressInfo");
      const timeFilterButtons = document.querySelectorAll(
        "#timeFilterButtons button"
      );

      // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø¯Ù…: { ØªÙ…Ø±ÙŠÙ†: [ {weight, date} ] }
      let progressData = JSON.parse(localStorage.getItem("progressData")) || {};
      // Ø­ÙØ¸ Ø§Ù„ÙˆØ²Ù† Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
      let tempWeights = {};
      const sectionsMap = {};

      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢Ø®Ø± ÙˆØ²Ù† Ù…Ø³Ø¬Ù„ Ù„Ù„ØªÙ…Ø±ÙŠÙ†
      function getLastWeight(ex) {
        if (tempWeights[ex] !== undefined) return tempWeights[ex];
        return progressData[ex]?.slice(-1)[0]?.weight || 0;
      }

      // Ø¨Ù†Ø§Ø¡ Ù‚Ø³Ù… Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†
      function createExerciseSection() {
        trackerDiv.innerHTML = ""; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù‚Ø³Ù… Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ù…Ù‡Ù… Ø¹Ù†Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡)
        for (let group in exercises) {
          const section = document.createElement("div");
          section.className = "section";
          section.dataset.group = group;
          section.innerHTML = `<h2>${group}</h2>`;

          exercises[group].forEach((exercise) => {
            const container = document.createElement("div");
            container.className = "exercise-container";
            container.innerHTML = `
    <label>${exercise}</label>
    <div class="weight-controls">
      <button onclick="changeWeight('${exercise}', 2.5)">â¬†</button>
      <input type="number" id="${exercise}-weight" step="2.5" min="0" value="${getLastWeight(
              exercise
            )}" />
      <button onclick="changeWeight('${exercise}', -2.5)">â¬‡</button>
      <button class="delete-exercise-btn" onclick="deleteExercise('${group}', '${exercise}')">ğŸ—‘ï¸</button>
    </div>
  `;
            section.appendChild(container);

            // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ ÙƒÙ…Ø§ Ù‡Ùˆ
          });
          trackerDiv.appendChild(section);
          sectionsMap[group] = section;
        }
        updateExerciseSelector();
      }

      function deleteExercise(group, exercise) {
        if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„ØªÙ…Ø±ÙŠÙ† "${exercise}"ØŸ`)) return;

        // Ø­Ø°Ù Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†
        exercises[group] = exercises[group].filter((ex) => ex !== exercise);

        // Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ù…Ù† progressData Ø¥Ù† ÙˆØ¬Ø¯Øª
        if (progressData[exercise]) {
          delete progressData[exercise];
          localStorage.setItem("progressData", JSON.stringify(progressData));
        }

        // Ø­ÙØ¸ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        saveExercises();

        // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
        createExerciseSection();
        updateExerciseSelector();
        updateProgressInfo();
      }

      // ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ²Ù† Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
      function changeWeight(exercise, delta) {
        const input = document.getElementById(`${exercise}-weight`);
        let currentVal = parseFloat(input.value) || 0;
        currentVal += delta;
        if (currentVal < 0) currentVal = 0;
        input.value = currentVal;
        tempWeights[exercise] = currentVal;
      }

      // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ localStorage
      saveBtn.onclick = () => {
        for (const ex in tempWeights) {
          if (!progressData[ex]) progressData[ex] = [];
          // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ù…Ø¹ Ø§Ù„ÙˆØ²Ù† ÙÙ‚Ø· Ø¥Ø°Ø§ ØªØºÙŠØ± Ø§Ù„ÙˆØ²Ù†
          const lastEntry = progressData[ex].slice(-1)[0];
          if (!lastEntry || lastEntry.weight !== tempWeights[ex]) {
            progressData[ex].push({
              weight: tempWeights[ex],
              date: new Date().toISOString(),
            });
          }
        }
        localStorage.setItem("progressData", JSON.stringify(progressData));
        tempWeights = {};
        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
      };

      // Ø¥Ø¶Ø§ÙØ© ØªÙ…Ø±ÙŠÙ† Ø¬Ø¯ÙŠØ¯
      function addNewExercise() {
        const group = document.getElementById("exerciseGroup").value;
        const name = newExerciseInput.value.trim();
        if (!name) {
          alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØªÙ…Ø±ÙŠÙ†");
          return;
        }
        if (exercises[group].includes(name)) {
          alert("Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ù‹Ø§ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø©");
          return;
        }
        exercises[group].push(name);
        saveExercises();
        createExerciseSection();
        newExerciseInput.value = "";
        alert("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ…Ø±ÙŠÙ†");
      }

      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
      function showExercises(group) {
        for (const key in sectionsMap) {
          if (key === group) {
            sectionsMap[key].style.display = "block";
          } else {
            sectionsMap[key].style.display = "none";
          }
        }
        document.getElementById("showAllBtn").style.display = "inline-block";
      }

      // Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†
      function showAllExercises() {
        for (const key in sectionsMap) {
          sectionsMap[key].style.display = "block";
        }
        document.getElementById("showAllBtn").style.display = "none";
      }

      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ù„Ù„ØªØ·ÙˆØ±
      function updateExerciseSelector() {
        exerciseSelector.innerHTML =
          '<option value="">Ø§Ø®ØªØ± ØªÙ…Ø±ÙŠÙ†</option>';
        for (const group in exercises) {
          exercises[group].forEach((ex) => {
            const option = document.createElement("option");
            option.value = ex;
            option.textContent = ex;
            exerciseSelector.appendChild(option);
          });
        }
      }

      // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ·ÙˆØ± Ø­Ø³Ø¨ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø²Ù…Ù†ÙŠ
      function calculateProgress(exercise, filter) {
        const data = progressData[exercise] || [];
        if (data.length === 0) return null;

        const now = new Date();
        let filteredData;

        switch (filter) {
          case "day":
            filteredData = data.filter((item) => {
              const d = new Date(item.date);
              return (now - d) / (1000 * 3600) <= 24;
            });
            break;
          case "week":
            filteredData = data.filter((item) => {
              const d = new Date(item.date);
              return (now - d) / (1000 * 3600 * 24) <= 7;
            });
            break;
          case "month":
            filteredData = data.filter((item) => {
              const d = new Date(item.date);
              return (now - d) / (1000 * 3600 * 24) <= 30;
            });
            break;
          case "all":
            filteredData = data;
            break;
          default:
            filteredData = data;
        }

        if (filteredData.length < 2) return null; // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ù„Ø­Ø³Ø§Ø¨

        const firstWeight = filteredData[0].weight;
        const lastWeight = filteredData[filteredData.length - 1].weight;
        if (firstWeight === 0) return null;

        const diff = lastWeight - firstWeight;
        const percent = ((diff / firstWeight) * 100).toFixed(0);
        return { firstWeight, lastWeight, diff, percent };
      }

      // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØªØ·ÙˆØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ…Ø±ÙŠÙ† ÙˆØ§Ù„ÙÙ„ØªØ± Ø§Ù„Ø²Ù…Ù†ÙŠ
      function updateProgressInfo() {
        const selectedExercise = exerciseSelector.value;
        if (!selectedExercise) {
          progressInfo.textContent = "Ø§Ø®ØªØ± ØªÙ…Ø±ÙŠÙ†Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ·ÙˆØ±";
          return;
        }
        const activeFilterBtn = document.querySelector(
          "#timeFilterButtons button.active"
        );
        const filter = activeFilterBtn
          ? activeFilterBtn.getAttribute("data-filter")
          : "all";
        const progress = calculateProgress(selectedExercise, filter);
        if (!progress) {
          progressInfo.textContent = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ·ÙˆØ±";
          return;
        }
        let sign = progress.diff > 0 ? "+" : "";
        progressInfo.textContent = `ØªØ·ÙˆØ± Ø§Ù„ÙˆØ²Ù† Ù…Ù† ${progress.firstWeight} ÙƒØ¬Ù… Ø¥Ù„Ù‰ ${progress.lastWeight} ÙƒØ¬Ù… (${sign}${progress.diff} ÙƒØ¬Ù…, ${sign}${progress.percent}%)`;
      }

      // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±
      exerciseSelector.addEventListener("change", updateProgressInfo);

      // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
      timeFilterButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          timeFilterButtons.forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          updateProgressInfo();
        });
      });

      // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ - Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ù…Ø¹ Ø§Ù„Ø­ÙØ¸
      const toggleDarkModeBtn = document.getElementById("toggleDarkMode");
      toggleDarkModeBtn.addEventListener("click", () => {
        document.body.classList.toggle("dark-mode");
        document
          .getElementById("progressSection")
          .classList.toggle("dark-mode");

        // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©
        const isDark = document.body.classList.contains("dark-mode");
        localStorage.setItem("darkMode", isDark ? "enabled" : "disabled");
      });

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
      const savedDarkMode = localStorage.getItem("darkMode");
      if (savedDarkMode === "enabled") {
        document.body.classList.add("dark-mode");
        document.getElementById("progressSection").classList.add("dark-mode");
      } else {
        document.body.classList.remove("dark-mode");
        document
          .getElementById("progressSection")
          .classList.remove("dark-mode");
      }

      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø£ÙˆÙ„ Ù…Ø±Ø©
      createExerciseSection();
      updateProgressInfo();

      // Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
      createExerciseSection();
      showAllExercises();
    </script>
  </body>
</html>
